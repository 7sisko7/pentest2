
jQuery(document).ready(function() {
	recalculateCart();

	$(".popupDialog").on("click", function(event){
    	event.stopPropagation();
    });
});

function displayFlyout(id,val){
	if(val == 1) {
		$(id).show();
	} else {
		$(id).hide();
	}
}

function recalculateCart() {
	jQuery.ajax({
        url:'/general/shoppingCartCount.action',
        cache: false,
        success: function(data) {
        	varCartCount = parseInt(data.count);
        	
        	if(varCartCount > 0) {
        		jQuery(".cartCount").html("Cart (" + varCartCount + ")");
        		jQuery(".cartCountSmall").html("(" + varCartCount + ")");
        	} else {
        		jQuery(".cartCount").html("Cart");
        	}
        }
    });
}

function hidePopups(){
	$(".popupBGBlocking").addClass("invisible");
	$("body").removeClass("overflow-hidden");
	$("#mergeShoppingCartDialog").hide();
}

function showPopup(idName){
	$(".popupBGBlocking").removeClass("invisible");
	$("body").addClass("overflow-hidden");
	$("#" + idName).show();	
}

function showShoppingCartMergeDialog() {
	showPopup("mergeShoppingCartDialog");
}

function mergeShoppingCart() {
	jQuery.ajax({
        url: "/general/mergeShoppingCart.action",
        type: "POST",
        data: { type : "merge" },
        cache: false,
        success: function(data) {
        	recalculateCart();
        	hidePopups();
        }
    });
}

function discardPreviousShoppingCart() {
	jQuery.ajax({
        url: "/general/mergeShoppingCart.action",
        type: "POST",
        data: { type : "discardPrevious" },
        cache: false,
        success: function(data) {
        	recalculateCart();
        	hidePopups();
        }
    });
}

function usePreviousShoppingCart() {
	jQuery.ajax({
        url: "/general/mergeShoppingCart.action",
        type: "POST",
        data: { type : "usePrevious" },
        cache: false,
        success: function(data) {
        	recalculateCart();
        	hidePopups();
        }
    });
}

function resizeTranslate() {
	var windowSize = window.innerWidth;
	var tabletBreak = 1000;
	var phoneBreak = 800;

	var translateHtml = $("#google_translate_element").parent().html();
	if(windowSize > tabletBreak && currentSize !== "desktop") {
		currentSize = "desktop";
		$(".tablet_header .google_translate_element_container").html("");
		$(".mobile_header .google_translate_element_container").html("");
		$(".desktop .google_translate_element_container").html(translateHtml);
		checkScrollBar();
		setBodyMarginBottom();
	} else if(windowSize > phoneBreak && windowSize <= tabletBreak && currentSize !== "tablet") {
		currentSize = "tablet";
		$(".desktop .google_translate_element_container").html("");
		$(".mobile_header .google_translate_element_container").html("");
		$(".tablet_header .google_translate_element_container").html(translateHtml);
		checkScrollBar();
		setBodyMarginBottom();
	} else if(windowSize <= phoneBreak && currentSize !== "phone") {
		currentSize = "phone";
		$(".desktop .google_translate_element_container").html("");
		$(".tablet_header .google_translate_element_container").html("");
		$(".mobile_header .google_translate_element_container").html(translateHtml);
		checkScrollBar();
		setBodyMarginBottom();
	}
}

